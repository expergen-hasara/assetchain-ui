{% extends "base.html" %}
{% block title %}Marketplace{% endblock %}
{% block body %}
{% include "topbar.html" %}
<div class="layout">
  {% include "sidebar.html" %}
  <div class="main">
    <div class="page-header">
      <div><div class="page-title">Marketplace</div><div class="page-sub">Browse tokenized assets available for purchase</div></div>
      <div class="btn-row">
        <input class="form-input" style="width:200px;" placeholder="ðŸ” Search assets..." readonly/>
        <button class="btn btn-secondary">âš™ Filter</button>
      </div>
    </div>
    <!-- filter tags: allow wrapping on small screens -->
    <div style="display:flex;gap:8px;margin-bottom:24px;flex-wrap:wrap;">
      {% for t in asset_types %}
      <a href="/marketplace?type={{ t }}" class="tag {% if t == active_filter %}tag-blue{% else %}tag-amber{% endif %}" style="text-decoration:none;padding:7px 14px;cursor:pointer;">{{ t }}</a>
      {% endfor %}
    </div>
    <div class="marketplace-grid">
      {% for a in assets %}
      <div class="mkt-card">
        <div class="mkt-thumb" style="background:{{ a.color }}22;">{{ a.emoji }}</div>
        <div class="mkt-body">
          <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px;gap:8px;">
            <div style="font-family:'Syne',sans-serif;font-weight:700;font-size:14px;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">{{ a.name }}</div>
            <span class="tag tag-{% if a.status=='Active' %}green{% elif a.status=='IPO' %}red{% elif a.status=='Partial' %}amber{% else %}blue{% endif %}" style="flex-shrink:0;">{{ a.status }}</span>
          </div>
          <div style="font-size:12px;color:var(--muted);margin-bottom:12px;">{{ a.type }} Â· {{ a.location }}</div>
          <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
            <div><div style="font-size:11px;color:var(--muted);">Price/Token</div><div style="font-family:'Syne',sans-serif;font-weight:700;font-size:18px;">${{ a.price }}</div></div>
            <div style="text-align:right;"><div style="font-size:11px;color:var(--muted);">Total Value</div><div style="font-family:'Syne',sans-serif;font-weight:700;font-size:18px;">${{ "{:,.0f}".format(a.valuation / 1000) }}K</div></div>
          </div>
          {% if a.supply > 0 %}
          <div style="margin-bottom:14px;">
            <div style="display:flex;justify-content:space-between;font-size:11px;color:var(--muted);margin-bottom:4px;"><span>Sold</span><span>{{ (a.sold / a.supply * 100)|int }}%</span></div>
            <div class="progress-bar"><div class="progress-fill" style="width:{{ (a.sold / a.supply * 100)|int }}%;"></div></div>
          </div>
          {% endif %}
          <a href="/transfer" class="btn btn-primary" style="width:100%;justify-content:center;font-size:13px;padding:9px;">Buy Tokens â†’</a>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
