{% extends "base.html" %}
{% block title %}Profile{% endblock %}
{% block body %}
{% include "topbar.html" %}
<div class="layout">
  {% include "sidebar.html" %}
  <div class="main">
    <div class="page-header">
      <div><div class="page-title">My Profile</div><div class="page-sub">Manage your account and preferences</div></div>
    </div>
    {% if success %}<div class="alert alert-success">{{ success }}</div>{% endif %}
    <div class="profile-grid">
      <!-- PROFILE CARD -->
      <div class="card" style="text-align:center;padding:32px 24px;height:fit-content;">
        <div style="width:80px;height:80px;border-radius:50%;background:linear-gradient(135deg,var(--accent),var(--accent4));display:flex;align-items:center;justify-content:center;font-size:32px;margin:0 auto 16px;">
          {{ user.first_name[0] }}
        </div>
        <div style="font-family:'Syne',sans-serif;font-weight:800;font-size:20px;">{{ user.first_name }} {{ user.last_name }}</div>
        <div style="font-size:13px;color:var(--muted);margin-bottom:4px;">{{ session.user if session.user }}</div>
        <div style="font-size:12px;font-family:'DM Mono',monospace;color:var(--accent);margin-bottom:20px;">{{ user.role }}</div>
        <div style="background:var(--surface2);border-radius:10px;padding:12px;margin-bottom:16px;">
          <div style="font-size:11px;color:var(--muted);margin-bottom:4px;font-family:'DM Mono',monospace;">WALLET</div>
          <div style="font-size:11px;font-family:'DM Mono',monospace;overflow-wrap:break-word;">{{ user.wallet }}</div>
        </div>
        <div style="display:flex;justify-content:space-around;margin-bottom:20px;">
          <div style="text-align:center;"><div style="font-family:'Syne',sans-serif;font-weight:800;font-size:20px;">{{ total_assets }}</div><div style="font-size:11px;color:var(--muted);">Assets</div></div>
          <div style="text-align:center;"><div style="font-family:'Syne',sans-serif;font-weight:800;font-size:20px;">59K</div><div style="font-size:11px;color:var(--muted);">Tokens</div></div>
          <div style="text-align:center;"><div style="font-family:'Syne',sans-serif;font-weight:800;font-size:20px;">#1</div><div style="font-size:11px;color:var(--muted);">Rank</div></div>
        </div>
        <a href="/logout" class="btn btn-danger" style="width:100%;justify-content:center;">⏏ Sign Out</a>
      </div>
      <!-- SETTINGS -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">Account Settings</div>
          <button type="submit" form="profile-form" class="btn btn-primary">Save Changes</button>
        </div>
        <div class="card-body">
          <div style="font-size:13px;color:var(--accent);font-family:'DM Mono',monospace;margin-bottom:16px;text-transform:uppercase;">Personal Information</div>
          <form method="POST" id="profile-form">
            <div class="form-row">
              <div class="form-group"><label class="form-label">First Name</label><input class="form-input" type="text" name="first_name" value="{{ user.first_name }}"/></div>
              <div class="form-group"><label class="form-label">Last Name</label><input class="form-input" type="text" name="last_name" value="{{ user.last_name }}"/></div>
            </div>
            <div style="font-size:13px;color:var(--accent);font-family:'DM Mono',monospace;margin:20px 0 16px;text-transform:uppercase;">Blockchain Settings</div>
            <div class="form-group"><label class="form-label">Wallet Address</label><input class="form-input" type="text" name="wallet" value="{{ user.wallet }}" style="font-family:'DM Mono',monospace;font-size:13px;"/></div>
            <div class="form-group"><label class="form-label">Network</label><select class="form-select"><option>Ethereum Mainnet</option><option>Polygon</option><option>Ganache (Local)</option></select></div>
          </form>
          <div style="font-size:13px;color:var(--accent);font-family:'DM Mono',monospace;margin:20px 0 16px;text-transform:uppercase;">Notification Preferences</div>
          {% for label, sub in [('Transaction Confirmations','Alert when tokens are sent/received'),('Price Alerts','Notify on ±10% price changes'),('Top 10 Rank Changes','Alert on holder rank changes'),('New Asset Listings','Notify about new marketplace listings')] %}
          <div style="display:flex;justify-content:space-between;align-items:center;padding:14px 0;border-bottom:1px solid rgba(255,255,255,.04);gap:12px;">
            <div style="min-width:0;"><div style="font-size:13px;font-weight:600;">{{ label }}</div><div style="font-size:12px;color:var(--muted);">{{ sub }}</div></div>
            <div style="width:44px;height:24px;background:var(--accent);border-radius:12px;position:relative;cursor:pointer;flex-shrink:0;">
              <div style="position:absolute;right:3px;top:3px;width:18px;height:18px;background:white;border-radius:50%;"></div>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</div>
<style>
.profile-grid{display:grid;grid-template-columns:280px 1fr;gap:24px;}
@media(max-width:900px){.profile-grid{grid-template-columns:1fr;}}
</style>
{% endblock %}
